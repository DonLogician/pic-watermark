# 图片水印工具产品需求文档

## 1. 产品概述

### 1.1 产品目的
提供一款简洁高效的图片水印工具，帮助用户轻松为图片添加文本或图片水印，保护知识产权并增强品牌识别。

### 1.2 产品价值
- 提供便捷的单张和批量图片水印处理功能
- 支持自定义水印内容、样式和位置
- 实时预览水印效果，确保用户满意
- 保存和管理水印模板，提高工作效率

## 2. 功能需求

### 2.1 文件处理

#### 2.1.1 导入图片
- 支持单张图片拖拽或通过文件选择器导入
- 支持批量导入，可一次性选择多张图片或直接导入整个文件夹
- 在界面上显示已导入图片的列表（缩略图和文件名）

#### 2.1.2 支持格式
- 输入格式：必须支持JPEG、PNG，建议支持BMP、TIFF，PNG格式必须支持透明通道
- 输出格式：用户可选择输出为JPEG或PNG

#### 2.1.3 导出图片
- 用户可指定输出文件夹，默认禁止导出到原文件夹以防止覆盖原图
- 提供导出文件命名规则选项：保留原文件名、添加自定义前缀、添加自定义后缀
- 对于JPEG格式，提供图片质量（压缩率）调节滑块（0-100）（可选高级功能）
- 导出时允许用户调整图片尺寸（如按宽度、高度或百分比缩放）（可选高级功能）

### 2.2 水印类型

#### 2.2.1 文本水印
- 内容：用户可自定义输入任意文本
- 透明度：可调节文本的透明度（0-100%）
- 字体：可选择系统已安装的字体、字号、粗体、斜体（可选高级功能）
- 颜色：提供调色板让用户选择字体颜色（可选高级功能）
- 样式：可添加阴影或描边效果，以增强在复杂背景下的可读性（可选高级功能）

#### 2.2.2 图片水印（可选高级功能）
- 用户可从本地选择一张图片（如Logo）作为水印
- 必须支持带透明通道的PNG图片
- 缩放：可按比例或自由调整图片水印的大小
- 透明度：可调节图片水印的整体透明度（0-100%）

### 2.3 水印布局与样式

#### 2.3.1 实时预览
- 所有对水印的调整都应在主预览窗口中实时显示效果
- 用户可以点击图片列表切换预览不同的图片

#### 2.3.2 位置
- 预设位置：提供九宫格布局（四角、正中心），用户可一键将水印放置在这些位置
- 手动拖拽：用户可以直接在预览图上通过鼠标拖拽水印到任意位置

#### 2.3.3 旋转
- 提供一个滑块或输入框，允许用户以任意角度旋转水印（可选高级功能）

### 2.4 配置管理

#### 2.4.1 水印模板
- 用户可以将当前的水印设置（包括水印内容、字体、颜色、位置、大小、透明度等所有参数）保存为一个模板
- 用户可以加载、管理和删除已保存的模板
- 程序启动时可自动加载上一次关闭时的设置或一个默认模板

## 3. 非功能需求

### 3.1 用户界面
- 简洁直观的操作界面，易于上手
- 清晰的布局和视觉引导，帮助用户快速找到所需功能
- 响应式设计，适应不同屏幕尺寸

### 3.2 性能要求
- 处理单张图片水印的响应时间应在1秒以内
- 批量处理图片时应提供进度反馈，处理速度应满足一般用户需求
- 占用系统资源应合理，不影响其他程序运行

### 3.3 兼容性
- 兼容Windows 10及以上操作系统
- 支持主流图片格式（JPEG、PNG、BMP、TIFF）的处理
- 与Python 3.9及以上版本兼容

### 3.4 安全性
- 确保用户数据的隐私和安全，不收集或上传用户图片
- 防止恶意代码执行，保障系统安全

## 4. 技术要求

### 4.1 开发语言
- 使用Python 3.9进行开发

### 4.2 依赖库
- 图像处理库：Pillow（用于图片读取、处理和保存）
- 其他依赖库详见requirements.txt文件

### 4.3 项目结构
- 采用标准src目录布局，核心功能模块位于src/watermark_tools目录
- 入口文件为根目录下的pic_watermark.py

### 4.4 代码规范
- 遵循Python PEP 8代码规范
- 提供清晰的函数和变量命名
- 添加必要的注释，提高代码可读性

## 5. 项目计划与交付标准

### 5.1 时间线
- 需求分析和PRD编写：已完成
- 项目结构重构：已完成
- 核心功能开发：进行中
- 测试和优化：待进行
- 发布和部署：待进行

### 5.2 里程碑
- 完成项目结构重构，实现标准src布局
- 实现基本的文本水印功能
- 实现批量处理功能
- 完成全部核心功能开发
- 发布可运行的Windows或MacOS安装包

### 5.3 验收标准
- 所有核心功能（文件处理、文本水印、基本布局、配置管理）均已实现
- 程序运行稳定，无明显bug
- 提供清晰的用户文档和使用说明
- 代码提交到GitHub，提供可直接下载运行的release版本

## 6. 优先级说明
- 核心功能（文件处理、文本水印、基本布局）为高优先级，必须实现
- 高级功能（图片水印、旋转、字体选择等）为中低优先级，尽可能实现